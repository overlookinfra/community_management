google.charts.load("current", { packages: ["corechart"] });
function drawRunsChart() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:total_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:total_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for the last 5 runs',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_total_runs'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawRunsChart);

function drawChart_last_run() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:last_night_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:last_night_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for last night run',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_last_run'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawChart_last_run);

function drawStepsTotalChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:total_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:total_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:total_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:total_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>],
            ]);

            var options = {title: 'Failed steps for the last 5 runs'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_total'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsTotalChart);

function drawStepsRunChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:last_night_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:last_night_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:last_night_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:last_night_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>]
            ]);

            var options = {title: 'Failed steps for the last run'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_run'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsRunChart);google.charts.load("current", { packages: ["corechart"] });
function drawRunsChart() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:total_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:total_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for the last 5 runs',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_total_runs'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawRunsChart);

function drawChart_last_run() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:last_night_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:last_night_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for last night run',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_last_run'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawChart_last_run);

function drawStepsTotalChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:total_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:total_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:total_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:total_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>],
            ]);

            var options = {title: 'Failed steps for the last 5 runs'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_total'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsTotalChart);

function drawStepsRunChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:last_night_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:last_night_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:last_night_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:last_night_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>]
            ]);

            var options = {title: 'Failed steps for the last run'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_run'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsRunChart);google.charts.load("current", { packages: ["corechart"] });
function drawRunsChart() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:total_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:total_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for the last 5 runs',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_total_runs'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawRunsChart);

function drawChart_last_run() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:last_night_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:last_night_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for last night run',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_last_run'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawChart_last_run);

function drawStepsTotalChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:total_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:total_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:total_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:total_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>],
            ]);

            var options = {title: 'Failed steps for the last 5 runs'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_total'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsTotalChart);

function drawStepsRunChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:last_night_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:last_night_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:last_night_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:last_night_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>]
            ]);

            var options = {title: 'Failed steps for the last run'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_run'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsRunChart);google.charts.load("current", { packages: ["corechart"] });
function drawRunsChart() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:total_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:total_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for the last 5 runs',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_total_runs'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawRunsChart);

function drawChart_last_run() {
    var data = google.visualization.arrayToDataTable([
        ['Job Status', 'Total'],
        ['Success', <%= result_hash.map { |x| x[:last_night_successes] }.reduce(0) { |sum, num| sum + num } %>],
        ['Failure', <%= result_hash.map { |x| x[:last_night_failures] }.reduce(0) { |sum, num| sum + num } %>]
    ]);
    var options = {
        title: 'Runs Overview for last night run',
        slices: [{ color: 'green' }, { color: 'red' }],
        pieHole: 0.4,
    };
    var chart = new google.visualization.PieChart(document.getElementById('donutchart_last_run'));
    chart.draw(data, options);
}
google.charts.setOnLoadCallback(drawChart_last_run);

function drawStepsTotalChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:total_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:total_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:total_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:total_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>],
            ]);

            var options = {title: 'Failed steps for the last 5 runs'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_total'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsTotalChart);

function drawStepsRunChart(){
    var data = google.visualization.arrayToDataTable([
               ['Steps', 'Failure'],
               ['Provision',  <%= result_hash.map { |x| x[:last_night_provision_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install agent',  <%= result_hash.map { |x| x[:last_night_install_agent_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Install module',  <%= result_hash.map { |x| x[:last_night_install_module_failures] }.reduce(0) { |sum, num| sum + num } %>],
               ['Acceptance',  <%= result_hash.map { |x| x[:last_night_run_acceptance_failures] }.reduce(0) { |sum, num| sum + num } %>]
            ]);

            var options = {title: 'Failed steps for the last run'}; 

            // Instantiate and draw the chart.
            var chart = new google.visualization.ColumnChart(document.getElementById('steps_chart_run'));
            chart.draw(data, options);
         }
         google.charts.setOnLoadCallback(drawStepsRunChart);